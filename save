#!/usr/bin/perl
### Guarda una copia numerada del fichero
#==============================================================================#
# INIT                                                                         #
#==============================================================================#
#--------------------------------------------------------------+
# Pragmas                                                      |
#--------------------------------------------------------------+
use strict;
#--------------------------------------------------------------+
# Variables                                                    |
#--------------------------------------------------------------+
my $f       = shift;
my $cf      = shift || '';
my $date    = `date +%F`;
my $time    = `date +%T`;
my $num     = "000";
my $t       = '';
my $comment = '';
chomp $date;
chomp $time;
#==============================================================================#
# MAIN                                                                         #
#==============================================================================#
if (!-f $f) {die "El fichero $f no es v√°lido\n"}
$num++ while (-f "Attic/$f.$num");
$t = "### $date $time $f.$num\n";
mkdir 'Attic' unless -d 'Attic';
system "cp -pruv $f Attic/$f.$num";
#--------------------------------------------------------------+
# Comentario                                                   |
#--------------------------------------------------------------+
if (-f $cf) {
    open FILE, $cf or die $!;
    while(<FILE>){
        $t .= $_;
    }
    close FILE;
}  else {
    print "Teclea el comentario:\n";
    while (<>) {
        $t .= $_;
    }
}
$t .= "\n";
$t .= '-' x 80;
$t .= "\n";
open FILE, ">>Attic/$f.txt" or die "$!";
print FILE $t;
close FILE;

